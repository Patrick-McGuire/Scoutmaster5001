      <script>
        var data = []
        var created = 0
        var activeID = ""
        var lastactiveID = ""
        document.getElementById("Tab1Colum").style.minHeight = "" + (screen.height/2) + "px"

        load()
        function load() {
          google.script.run.withSuccessHandler(function(dataIn) {
            data = []
            for(var i = 0; i < dataIn[0].length; i++) {
              data.push(JSON.parse(dataIn[0][i]))
              if(parseInt((data[i].id).replace("ENTRYID", "")) >= created) {
                created += 1
              }
            }
            drawView()
          }).getConfigData()
        }

        function saveDataEntryConfig() {
          var saveData = []
          for(var i = 0; i < data.length; i++) { saveData.push([JSON.stringify(data[i])] ) }
          google.script.run.withSuccessHandler(function() {
            google.script.run.setValues(null, "Config", "A3", "A" + (saveData.length + 2), saveData)
          }).clearContent(null, "Config", "A3", "A")
        }

        function deleteWiget() {
          for(var i = 0; i < data.length; i++) {
            if(data[i].id == activeID) {
              data.splice(i, 1)
            }
            drawView()
          }
        }
        function clearAll() {
          if(confirm("Are you sure?")) {
            data = []
            drawView()
          }
        }
        function reorder() {
          var tele = []
          var auto = []
          for(var i = 0; i < data.length; i++) {
            if(data[i].period == "Auto") {
              auto.push(data[i])
            } else {
              tele.push(data[i])
            }
          }
          data = auto
          for(var i = 0; i < tele.length; i++) {
            data.push(tele[i])
          }
        }

        function updateListOrder(isMoveUp) {
          reorder()
          var newList = []
          for(var i = 0; i < data.length; i++) {
            if(isMoveUp) {
              if(i+1 != data.length && activeID == data[i].id) {
                newList.push(data[i+1])
                newList.push(data[i])
                i += 1;
              } else {
                newList.push(data[i])
              }
            } else {

              if(i+1 != data.length && activeID == data[i+1].id) {
                newList.push(data[i+1])
                newList.push(data[i])
                i += 1;
              } else {
                newList.push(data[i])
              }
            }
          }
          data = newList
          reorder()
          drawView()
        }

        function getNewID() {
          var newWidgerID = "ENTRYID" + created
          // return newWidgerID
          var isGood = true;
          for(var i = 0; i < 100; i++) {
            newWidgerID = "ENTRYID" + created
            isGood = true

            for(var j = 0; j < data.length; j++) {
              if(data[j].id == newWidgerID) {
                isGood = false
              }
            }
            if(isGood) { break; }
            created += 1;
          }
          return newWidgerID
        }

        function newWidget() {
          var newWidgerID = getNewID()

          var blankData = {
            id: "ENTRYID" + created,
            name: "New " + created,
            period: "Auto",
            type: "PM",
          }
          if(activeID != "") { 
            for(var i = 0; i < data.length; i++) {
              if(data[i].id == activeID) {
                blankData.period = data[i].period
              }
            }
          }
          activeID = blankData.id
          data.push(blankData)
          created += 1

          updateSidebar()
          drawView()
        }
        function updateSidebar() {
          for(var i = 0; i < data.length; i++) {
            var json = data[i]
            if(json.id == activeID) {
              document.getElementById("activeName").value = json.name
              document.getElementById("AORT").value = json.period
              document.getElementById("Type").value = json.type
              try{ 
              document.getElementById(activeID).style.backgroundColor = "#484848"
              document.getElementById(lastactiveID).style.backgroundColor = "#282828"
              }catch(err) {}
              if(json.type == "SL") {
                var div = document.getElementById('CustomWidgetSettingsDiv')
                if(!document.getElementById("MinSliderConfig") || lastactiveID != activeID) {
                  div.innerHTML = ""
                  var minVal = 0
                  var maxVal = 100
                  var startVal = 0
                  if(json.hasOwnProperty("min")) { minVal = parseInt(json.min) }
                  if(json.hasOwnProperty("max")) { maxVal = parseInt(json.max) }
                  if(json.hasOwnProperty("start")) { startVal = parseInt(json.start) }
                  var maxLabel = document.createElement("LABLE")
                  maxLabel.innerHTML = "Max:&nbsp;&nbsp;"
                  var minLabel = document.createElement("LABLE")
                  minLabel.innerHTML = "Min:&nbsp;&nbsp;"
                  var startLabel = document.createElement("LABLE")
                  startLabel.innerHTML = "Inital:&nbsp;&nbsp;"
                  var max = document.createElement("INPUT")
                  max.id = "MaxSliderConfig"
                  max.className = "largeInput2"
                  max.onchange = sidebarUpdated
                  max.value = maxVal
                  var min = document.createElement("INPUT")
                  min.id = "MinSliderConfig"
                  min.value = minVal
                  min.className = "largeInput2"
                  min.onchange = sidebarUpdated
                  var start = document.createElement("INPUT")
                  start.id = "StartSliderConfig"
                  start.value = startVal
                  start.className = "largeInput2"
                  start.onchange = sidebarUpdated
                  div.appendChild(document.createElement("BR"))
                  div.appendChild(maxLabel)
                  div.appendChild(max)
                  div.appendChild(document.createElement("BR"))
                  div.appendChild(document.createElement("BR"))
                  div.appendChild(minLabel)
                  div.appendChild(min)
                  div.appendChild(document.createElement("BR"))
                  div.appendChild(document.createElement("BR"))
                  div.appendChild(startLabel)
                  div.appendChild(start)
                }
              } else if(json.type == "DD") {
                var div = document.getElementById('CustomWidgetSettingsDiv')
                if(!document.getElementById("DDOptons")  || lastactiveID != activeID) {
                  div.innerHTML = ""
                  div.appendChild(getNewTextBox({name:"List options seperated by new line", id:"DDOptons"}))
                  var a = document.getElementById("DDOptonsdataPickupIDAdder")
                  try {
                  for(var i = 0; i < (json.options).length; i++) {
                    a.value = a.value + (json.options)[i] + "\n"
                  }
                  } catch(err) {}
                  document.getElementById("DDOptons" + dataPickupIDAdder).onchange = sidebarUpdated
                }
              } else {
                var div = document.getElementById('CustomWidgetSettingsDiv')
                div.innerHTML = ""
              }
            }
          }
          lastactiveID = activeID
        }
        function sidebarUpdated() {
          for(var i = 0; i < data.length; i++) {
            var newJSON = {}
            var json = data[i]
            if(json.id == activeID) {
              json.name = document.getElementById("activeName").value
              json.period = document.getElementById("AORT").value
              json.type = document.getElementById("Type").value
              if(json.type == "SL") {
                try {
                  json.min = document.getElementById("MinSliderConfig").value
                  json.max = document.getElementById("MaxSliderConfig").value
                  json.start = document.getElementById("StartSliderConfig").value
                } catch(err) {}
              } else if(json.type == "DD") {
                try {
                  var dataAA = (document.getElementById("DDOptons" + dataPickupIDAdder).value).split("\n")
                  json.options = dataAA
                } catch(err) {}
              }
            }
          }
          drawView()
          updateSidebar()
        }
        function drawView() {
          document.getElementById('autoContent').innerHTML = ""
          document.getElementById('teleContent').innerHTML = ""
          for(var i = 0; i < data.length; i++) {
            var json = data[i]
            var dest = "autoContent"
            if(json.period == "Tele") { dest = "teleContent" }
            if(json.type == "PM") {
              var ele = getNewPlusMinus(json)
              ele.onclick = setActiveID.bind(null, ele.id)
              document.getElementById(dest).appendChild(ele);
            } else if(json.type == "CB") {
              var ele = getNewCheckbox(json)
              ele.onclick = setActiveID.bind(null, ele.id)
              document.getElementById(dest).appendChild(ele);
            } else if(json.type == "TE") {
              var ele = getNewTextBox(json)
              ele.onclick = setActiveID.bind(null, ele.id)
              document.getElementById(dest).appendChild(ele);
            } else if(json.type == "TM") {
              var ele = getNewTimmer(json)
              ele.onclick = setActiveID.bind(null, ele.id)
              document.getElementById(dest).appendChild(ele);
            } else if(json.type == "DD") {
              var ele = getNewDropDown(json)
              ele.onclick = setActiveID.bind(null, ele.id)
              document.getElementById(dest).appendChild(ele);
            } else if(json.type == "SL") {
              var ele = getNewSlider(json)
              ele.onclick = setActiveID.bind(null, ele.id)
              document.getElementById(dest).appendChild(ele);
            }
          }
        }
        function setActiveID(id) {
          activeID = id
          updateSidebar();
        }
        function correctColor() {
          try {
            document.getElementById(activeID).style.backgroundColor = '#484848'
          } catch(err) {}

        }

        function openPage(pageName, elmnt, color) {
          // Hide all elements with class="tabcontent" by default
          var i, tabcontent, tablinks;
          tabcontent = document.getElementsByClassName("tabcontent");
          for (i = 0; i < tabcontent.length; i++) {
            tabcontent[i].style.display = "none";
          }

          // Remove the background color of all tablinks/buttons
          tablinks = document.getElementsByClassName("tablink");
          for (i = 0; i < tablinks.length; i++) {
            tablinks[i].style.backgroundColor = "";
          }

          // Show the specific tab content
          document.getElementById(pageName).style.display = "block";

          // Add the specific color to the button used to open the tab content
          elmnt.style.backgroundColor = color;
        }
        setInterval(correctColor, 10)
        document.getElementById("defaultOpen").click();
      </script>